<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ü–µ—Ä–µ–¥–∞—á–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ URL</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background: #1e1e1e;
            color: #fff;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
            border: 1px solid #444;
            border-radius: 10px;
        }
        input, button {
            padding: 10px;
            margin: 5px;
            border-radius: 5px;
            border: 1px solid #444;
        }
        input {
            background: #2d2d2d;
            color: white;
            flex: 1;
        }
        button {
            background: #4da6ff;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background: #3a8fd8;
        }
        .message-display {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .generated-link {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            word-break: break-all;
        }
        .input-group {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì® –ü–µ—Ä–µ–¥–∞—á–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ URL</h1>
        
        <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è -->
        <div class="message-display">
            <h3>üì• –ü–æ–ª—É—á–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:</h3>
            <div id="receivedMessage">–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è</div>
        </div>
        
        <!-- –§–æ—Ä–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è -->
        <h3>üì§ –°–æ–∑–¥–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:</h3>
        <div class="input-group">
            <input type="text" id="nameInput" placeholder="–¢–≤–æ–µ –∏–º—è" value="–ê–Ω–æ–Ω–∏–º">
            <input type="text" id="messageInput" placeholder="–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è">
        </div>
        <button onclick="generateMessageLink()">–°–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º</button>
        
        <!-- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞ -->
        <div class="generated-link">
            <h3>üîó –û—Ç–ø—Ä–∞–≤—å —ç—Ç—É —Å—Å—ã–ª–∫—É –¥—Ä—É–≥—É:</h3>
            <div id="linkOutput">–°—Å—ã–ª–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</div>
        </div>
        
        <!-- –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ -->
        <h3>üìã –¢–≤–æ–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:</h3>
        <button onclick="clearHistory()">–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
        <div id="history"></div>
    </div>

    <script>
        const HISTORY_KEY = 'messageLinksHistory';
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ URL –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            displayReceivedMessage();
            displayHistory();
        };
        
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        function displayReceivedMessage() {
            const urlParams = new URLSearchParams(window.location.search);
            const name = urlParams.get('name');
            const message = urlParams.get('message');
            
            const receivedDiv = document.getElementById('receivedMessage');
            
            if (name && message) {
                receivedDiv.innerHTML = `
                    <div style="font-size: 1.2em; margin: 10px 0;">
                        <strong>–û—Ç:</strong> ${escapeHtml(name)}<br>
                        <strong>–°–æ–æ–±—â–µ–Ω–∏–µ:</strong> ${escapeHtml(message)}
                    </div>
                `;
            } else {
                receivedDiv.innerHTML = '<div style="color: #888;">–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ URL</div>';
            }
        }
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º
        function generateMessageLink() {
            const name = document.getElementById('nameInput').value.trim();
            const message = document.getElementById('messageInput').value.trim();
            
            if (!name || !message) {
                alert('–ó–∞–ø–æ–ª–Ω–∏ –∏–º—è –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ!');
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
            const baseUrl = window.location.origin + window.location.pathname;
            const encodedName = encodeURIComponent(name);
            const encodedMessage = encodeURIComponent(message);
            const fullUrl = `${baseUrl}?name=${encodedName}&message=${encodedMessage}`;
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å—Å—ã–ª–∫—É
            document.getElementById('linkOutput').innerHTML = `
                <a href="${fullUrl}" target="_blank" style="color: #4da6ff; word-break: break-all;">
                    ${fullUrl}
                </a>
                <br><br>
                <button onclick="copyLink('${fullUrl}')" style="background: #555;">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
            `;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            saveToHistory(name, message, fullUrl);
            displayHistory();
        }
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        function saveToHistory(name, message, url) {
            let history = JSON.parse(localStorage.getItem(HISTORY_KEY)) || [];
            
            history.unshift({
                timestamp: new Date().toISOString(),
                name: name,
                message: message,
                url: url
            });
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º 20 –∑–∞–ø–∏—Å—è–º–∏
            if (history.length > 20) {
                history = history.slice(0, 20);
            }
            
            localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
        function displayHistory() {
            const historyContainer = document.getElementById('history');
            const history = JSON.parse(localStorage.getItem(HISTORY_KEY)) || [];
            
            if (history.length === 0) {
                historyContainer.innerHTML = '<p style="color: #888;">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</p>';
                return;
    <script>
    const HISTORY_KEY = 'messageHistory';
    
    // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        const name = urlParams.get('name');
        const message = urlParams.get('mes');
        
        // –ï—Å–ª–∏ –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        if (name && message) {
            saveToHistory(name, message);
            displayReceivedMessage(name, message);
        } else {
            document.getElementById('receivedMessage').innerHTML = '<div style="color: #888;">–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ URL</div>';
        }
        
        displayHistory();
    };
    
    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    function displayReceivedMessage(name, message) {
        document.getElementById('receivedMessage').innerHTML = `
            <div style="font-size: 1.2em; margin: 10px 0;">
                <strong>–û—Ç:</strong> ${escapeHtml(name)}<br>
                <strong>–°–æ–æ–±—â–µ–Ω–∏–µ:</strong> ${escapeHtml(message)}
            </div>
        `;
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
    function saveToHistory(name, message) {
        let history = JSON.parse(localStorage.getItem(HISTORY_KEY)) || [];
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç–∞ (–ø–æ —Å–æ–æ–±—â–µ–Ω–∏—é –∏ –≤—Ä–µ–º–µ–Ω–∏)
        const isDuplicate = history.some(item => 
            item.name === name && item.message === message && 
            (new Date() - new Date(item.timestamp)) < 5000 // 5 —Å–µ–∫—É–Ω–¥
        );
        
        if (!isDuplicate) {
            history.unshift({
                timestamp: new Date().toISOString(),
                name: name,
                message: message
            });
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º 30 –∑–∞–ø–∏—Å—è–º–∏
            if (history.length > 30) {
                history = history.slice(0, 30);
            }
            
            localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
        }
    }
    
    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
    function displayHistory() {
        const historyContainer = document.getElementById('history');
        const history = JSON.parse(localStorage.getItem(HISTORY_KEY)) || [];
        
        if (history.length === 0) {
            historyContainer.innerHTML = '<p style="color: #888;">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</p>';
            return;
        }
        
        let html = '';
        history.forEach((item) => {
            const date = new Date(item.timestamp);
            html += `
                <div style="background: #2d2d2d; padding: 10px; margin: 10px 0; border-radius: 5px; border-left: 3px solid #4da6ff;">
                    <div style="font-size: 0.8em; color: #888;">${date.toLocaleString('ru-RU')}</div>
                    <div><strong>${escapeHtml(item.name)}:</strong> ${escapeHtml(item.message)}</div>
                </div>
            `;
        });
        
        historyContainer.innerHTML = html;
    }
    
    // –ó–∞—â–∏—Ç–∞ –æ—Ç XSS
    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
</script>

                
</body>
</html>
